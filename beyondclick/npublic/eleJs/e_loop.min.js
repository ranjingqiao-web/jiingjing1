"use strict";
$define(["pagination", "pl_readyload"], function(i, r) {
    return {
        init: function() {
            var i, n, t, a, s = this._params, e = s.cid, o = s.id, c = this.scope;
            s._config && s._config._dataFilter && s._config._dataFilter.filter && !s._config._dataFilter.aloneFilter && $require(["filter"], function(i) {
                var n = {
                    glp: s,
                    scp: c,
                    cid: e,
                    eId: o,
                    afterFilter: function() {
                        var i = c.find('[class^="e_"]')
                          , n = [];
                        i.each(function() {
                            var i;
                            "true" == $(this).attr("needjs") && (i = $(this).attr("class").split(/\s+/)[0],
                            -1 == n.indexOf(i) && n.push(i))
                        }),
                        n.forEach(function(i) {
                            doElementJs(i, function() {}, e)
                        }),
                        r.assist()
                    }
                };
                i.init(n)
            }),
            s._config && s._config.params && (i = s._config.params.query,
            n = s._config.params,
            t = i,
            a = n,
            0 < c.find(".p_list").length && c.find(".p_list").pageInit({
                prop: s.propJson,
                i18n: s.i18nJson,
                queryParams: t,
                page: null == s.pageParamsJson ? s.propJson.page : s.pageParamsJson,
                view: (null == s.view ? window.pageObj.filename : s.view).toString(),
                id: s.id,
                cid: s.cid,
                sParams: a,
                successFun: function() {
                    var i = c.find('[class^="e_"]')
                      , t = [];
                    i.each(function() {
                        var i;
                        "true" == $(this).attr("needjs") && (i = $(this).attr("class").split(/\s+/)[0],
                        -1 == t.indexOf(i) && t.push(i))
                    }),
                    c.find(".p_loopitem").each(function(n, i) {
                        t.forEach(function(i) {
                            doElementJs(i, function() {}, e, "#" + e + " ." + o + " .p_list .p_loopitem:nth-child(" + (n + 1) + ") ." + i)
                        })
                    }),
                    r.assist()
                },
                callBackFun: function() {}
            }))
        }
    }
});
